```html
<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>科创板IPO穿行测试权威指南</title>
    <meta name="description" content="深度解析科创板IPO审核中采购穿行测试与研发费用核查的核心要求、监管红线与实战案例">
    
    <!-- 样式表 -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js"></script>
    
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-light: #ffffff;
            --text-dark: #e2e8f0;
            --text-light: #1e293b;
            --accent: #3b82f6;
            --accent-light: #60a5fa;
            --warning: #f59e0b;
            --error: #ef4444;
            --success: #10b981;
        }

        body {
            font-family: "Noto Sans SC", Tahoma, Arial, Roboto, "Droid Sans", "Helvetica Neue", "Droid Sans Fallback", "Heiti SC", "Hiragino Sans GB", Simsun, sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .font-serif {
            font-family: "Noto Serif SC", serif;
        }

        .dark-mode {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }

        .light-mode {
            background-color: var(--bg-light);
            color: var(--text-light);
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-card {
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 8px;
            width: 16px;
            height: 16px;
            background: var(--accent);
            border-radius: 50%;
            border: 3px solid var(--bg-dark);
        }

        .light-mode .timeline-item::before {
            border-color: var(--bg-light);
        }

        .mermaid-container {
            display: flex;
            justify-content: center;
            min-height: 300px;
            max-height: 800px;
            background: transparent;
            border: none;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            overflow: hidden;
        }

        .mermaid-container .mermaid {
            width: 100%;
            max-width: 100%;
            height: 100%;
            cursor: grab;
            transition: transform 0.3s ease;
            transform-origin: center center;
            display: flex;
            justify-content: center;
            align-items: center;
            touch-action: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .mermaid-container .mermaid svg {
            max-width: 100%;
            height: 100%;
            display: block;
            margin: 0 auto;
        }

        .mermaid-container .mermaid:active {
            cursor: grabbing;
        }

        .mermaid-container.zoomed .mermaid {
            height: 100%;
            width: 100%;
            cursor: grab;
        }

        .mermaid-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            z-index: 20;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px;
            border-radius: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mermaid-container:hover .mermaid-controls {
            opacity: 1;
        }

        .mermaid-control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 4px;
            padding: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            color: #fff;
            font-size: 14px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mermaid-control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .mermaid svg {
            max-width: none !important;
            height: auto;
            font-family: "Noto Sans SC", sans-serif !important;
        }

        .mermaid .node rect,
        .mermaid .node circle,
        .mermaid .node ellipse,
        .mermaid .node polygon {
            stroke-width: 2px;
        }

        .mermaid .edgeLabel {
            background-color: rgba(15, 23, 42, 0.8);
            color: #e2e8f0;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .light-mode .mermaid .edgeLabel {
            background-color: rgba(255, 255, 255, 0.9);
            color: #1e293b;
        }

        .case-study {
            position: relative;
            overflow: hidden;
        }

        .case-study::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--warning), var(--error));
        }

        .success-case::before {
            background: linear-gradient(90deg, var(--success), var(--accent));
        }

        .warning-badge {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .toc-link {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .toc-link:hover, .toc-link.active {
            border-left-color: var(--accent);
            background-color: rgba(59, 130, 246, 0.1);
        }

        .light-mode .toc-link:hover, .light-mode .toc-link.active {
            background-color: rgba(59, 130, 246, 0.05);
        }

        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .expandable-content.expanded {
            max-height: 1000px;
        }

        .expand-btn {
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .expand-btn.rotated {
            transform: rotate(180deg);
        }

        @media (max-width: 768px) {
            .mermaid-control-btn:not(.reset-zoom) {
                display: none;
            }
            .mermaid-controls {
                top: auto;
                bottom: 15px;
                right: 15px;
            }
        }
    </style>
</head>
<body class="dark-mode">
    <!-- 主题切换按钮 -->
    <button id="themeToggle" class="fixed top-4 right-4 z-50 p-3 rounded-full bg-gray-800 dark:bg-gray-700 hover:bg-gray-700 dark:hover:bg-gray-600 transition-all duration-300 shadow-lg">
        <i class="fas fa-moon text-yellow-400 dark:text-yellow-300"></i>
    </button>

    <!-- 目录导航 -->
    <nav id="toc" class="fixed left-4 top-1/2 transform -translate-y-1/2 z-40 hidden lg:block">
        <div class="bg-gray-900/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-lg p-4 glass-card">
            <h3 class="text-sm font-semibold mb-3 text-gray-300">快速导航</h3>
            <ul class="space-y-2 text-xs">
                <li><a href="#hero" class="toc-link block py-1 px-2 rounded">概述</a></li>
                <li><a href="#procurement" class="toc-link block py-1 px-2 rounded">采购测试</a></li>
                <li><a href="#rd" class="toc-link block py-1 px-2 rounded">研发费用</a></li>
                <li><a href="#checklist" class="toc-link block py-1 px-2 rounded">底稿清单</a></li>
                <li><a href="#cases" class="toc-link block py-1 px-2 rounded">案例解析</a></li>
                <li><a href="#reading" class="toc-link block py-1 px-2 rounded">延伸阅读</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero 区域 -->
    <section id="hero" class="min-h-screen flex items-center justify-center relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 dark:from-slate-900 dark:via-blue-900 dark:to-indigo-900"></div>
        <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%239C92AC" fill-opacity="0.05"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-20"></div>
        
        <div class="relative z-10 text-center max-w-4xl mx-auto px-6">
            <h1 class="text-5xl md:text-7xl font-bold font-serif mb-6 leading-tight">
                <span class="gradient-text">科创板IPO</span>
                <br>
                <span class="text-white">穿行测试权威指南</span>
            </h1>
            <p class="text-xl md:text-2xl text-gray-300 mb-8 font-light">
                深度解析采购与研发费用核查的监管红线 · 实战案例 · 底稿清单
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                <a href="#procurement" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium transition-all duration-300 hover-lift">
                    <i class="fas fa-chart-line mr-2"></i>开始阅读
                </a>
                <div class="text-sm text-gray-400">
                    <i class="fas fa-clock mr-1"></i>阅读时间约15分钟
                </div>
            </div>
        </div>

        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
            <i class="fas fa-chevron-down text-gray-400 text-xl"></i>
        </div>
    </section>

    <!-- 主要内容 -->
    <main class="max-w-6xl mx-auto px-6 py-16 space-y-20">

        <!-- 采购穿行测试 -->
        <section id="procurement" class="scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold font-serif mb-4">采购穿行测试</h2>
                <p class="text-xl text-gray-400">单据链完整性 · 职责分离 · 关联交易风险</p>
            </div>

            <div class="grid md:grid-cols-3 gap-8 mb-12">
                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-3xl mb-4 text-blue-400">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">单据链完整性</h3>
                    <p class="text-gray-400 text-sm">覆盖采购全流程：供应商选择→合同→订单→验收→入库→发票→付款</p>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-3xl mb-4 text-yellow-400">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">职责分离</h3>
                    <p class="text-gray-400 text-sm">禁止同一人操作领料与审批，确保内控有效性</p>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-3xl mb-4 text-red-400">
                        <i class="fas fa-link"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">关联交易</h3>
                    <p class="text-gray-400 text-sm">比对签章一致性，识别隐性关联方</p>
                </div>
            </div>

            <!-- 采购流程图 -->
            <div class="bg-gray-800/30 dark:bg-gray-100/5 rounded-xl p-8">
                <h3 class="text-2xl font-semibold mb-6 text-center">采购穿行测试流程图</h3>
                <div class="mermaid-container">
                    <div class="mermaid-controls">
                        <button class="mermaid-control-btn zoom-in" title="放大">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="mermaid-control-btn zoom-out" title="缩小">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button class="mermaid-control-btn reset-zoom" title="重置">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <button class="mermaid-control-btn fullscreen" title="全屏查看">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                            A["供应商选择"] --> B["合同审批"]
                            B --> C["采购订单"]
                            C --> D["验收单"]
                            D --> E["入库单"]
                            E --> F["发票"]
                            F --> G["付款单"]
                            
                            H["核查要点"] --> I["订单与入库数量一致性"]
                            H --> J["物流单地址匹配"]
                            H --> K["签收有效性"]
                            
                            style A fill:#3b82f6,stroke:#1e40af,color:#fff
                            style G fill:#10b981,stroke:#047857,color:#fff
                            style H fill:#f59e0b,stroke:#d97706,color:#fff
                    </div>
                </div>
            </div>
        </section>

        <!-- 研发费用测试 -->
        <section id="rd" class="scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold font-serif mb-4">研发费用穿行测试</h2>
                <p class="text-xl text-gray-400">科创板独有难点 · 工时制度 · 材料领用 · 试制品管理</p>
            </div>

            <div class="bg-gradient-to-r from-red-900/20 to-orange-900/20 rounded-xl p-8 mb-8">
                <div class="flex items-start space-x-4">
                    <div class="text-4xl text-red-400">
                        <i class="fas fa-exclamation-triangle warning-badge"></i>
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold mb-3 text-red-300">监管警示</h3>
                        <p class="text-gray-300">科创板对研发内控要求严苛，底稿缺失可能直接导致终止审核</p>
                    </div>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div class="space-y-6">
                    <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6">
                        <h3 class="text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-clock text-blue-400 mr-3"></i>
                            工时制度核查
                        </h3>
                        <ul class="space-y-2 text-sm text-gray-400">
                            <li>• 每日工时按项目记录</li>
                            <li>• 审批流程规范化</li>
                            <li>• 禁止口头沟通工时</li>
                        </ul>
                    </div>

                    <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6">
                        <h3 class="text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-boxes text-green-400 mr-3"></i>
                            材料领用管理
                        </h3>
                        <ul class="space-y-2 text-sm text-gray-400">
                            <li>• ERP系统登记</li>
                            <li>• 禁止直接报销入账</li>
                            <li>• 最早领用日期逻辑一致性</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-flask text-purple-400 mr-3"></i>
                        试制品全生命周期
                    </h3>
                    <div class="space-y-4">
                        <div class="border-l-4 border-purple-400 pl-4">
                            <h4 class="font-medium text-purple-300">数量记录</h4>
                            <p class="text-sm text-gray-400">试制品数量、去向完整记录</p>
                        </div>
                        <div class="border-l-4 border-purple-400 pl-4">
                            <h4 class="font-medium text-purple-300">客户反馈</h4>
                            <p class="text-sm text-gray-400">保存客户反馈记录及物流信息</p>
                        </div>
                        <div class="border-l-4 border-purple-400 pl-4">
                            <h4 class="font-medium text-purple-300">质量追溯</h4>
                            <p class="text-sm text-gray-400">建立质量追溯体系</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 底稿清单 -->
        <section id="checklist" class="scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold font-serif mb-4">保荐机构底稿必备清单</h2>
                <p class="text-xl text-gray-400">标准化底稿要求 · 核查要点 · 风险提示</p>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full bg-gray-800/30 dark:bg-gray-100/5 rounded-xl overflow-hidden">
                    <thead>
                        <tr class="bg-gray-700/50 dark:bg-gray-200/10">
                            <th class="px-6 py-4 text-left font-semibold">测试类型</th>
                            <th class="px-6 py-4 text-left font-semibold">底稿要求</th>
                            <th class="px-6 py-4 text-left font-semibold">核查要点</th>
                            <th class="px-6 py-4 text-left font-semibold">风险等级</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-700/50 dark:divide-gray-200/10">
                        <tr class="hover:bg-gray-700/20 transition-colors">
                            <td class="px-6 py-4 font-medium">
                                <i class="fas fa-shopping-cart text-blue-400 mr-2"></i>
                                采购穿行测试
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-400">
                                采购合同、订单、验收单、入库单、发票、付款单全链条单据
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-400">
                                数量一致性、地址匹配、签收有效性
                            </td>
                            <td class="px-6 py-4">
                                <span class="px-2 py-1 bg-yellow-500/20 text-yellow-300 rounded text-xs">中等</span>
                            </td>
                        </tr>
                        <tr class="hover:bg-gray-700/20 transition-colors">
                            <td class="px-6 py-4 font-medium">
                                <i class="fas fa-flask text-red-400 mr-2"></i>
                                研发费用测试
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-400">
                                工时表及审批单、考勤记录、材料领用单、试制品管理文件、费用分摊依据
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-400">
                                工时记录规范、材料领用系统登记、试制品全生命周期管理
                            </td>
                            <td class="px-6 py-4">
                                <span class="px-2 py-1 bg-red-500/20 text-red-300 rounded text-xs">高危</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 案例解析 -->
        <section id="cases" class="scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold font-serif mb-4">监管案例深度解析</h2>
                <p class="text-xl text-gray-400">失败教训 · 成功要素 · 监管逻辑</p>
            </div>

            <div class="space-y-8">
                <!-- 失败案例 -->
                <div class="case-study bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-8">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-semibold text-red-300">失败案例：浙江光华</h3>
                        <button class="expand-btn text-gray-400 hover:text-white">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="expandable-content">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold mb-3 text-red-200">问题诊断</h4>
                                <ul class="space-y-2 text-sm text-gray-400">
                                    <li>• 试制品无数量记录</li>
                                    <li>• 缺乏客户反馈文件</li>
                                    <li>• 无物流信息追溯</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-3 text-red-200">监管启示</h4>
                                <p class="text-sm text-gray-400">
                                    试制品需建立全生命周期管理档案，包括生产、流转、使用、反馈等完整记录链。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="case-study bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-8">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-semibold text-red-300">失败案例：艾索信息</h3>
                        <button class="expand-btn text-gray-400 hover:text-white">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="expandable-content">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold mb-3 text-red-200">问题诊断</h4>
                                <ul class="space-y-2 text-sm text-gray-400">
                                    <li>• 研发领料单审批人与领料人为同一人</li>
                                    <li>• 职责分离失效</li>
                                    <li>• 内控制度形同虚设</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-3 text-red-200">监管启示</h4>
                                <p class="text-sm text-gray-400">
                                    穿行测试必须覆盖职责分离有效性，确保不相容职务分离的内控制度有效执行。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 成功案例 -->
                <div class="case-study success-case bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-8">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-semibold text-green-300">成功案例：亿华通（688339）</h3>
                        <button class="expand-btn text-gray-400 hover:text-white">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="expandable-content">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold mb-3 text-green-200">成功要素</h4>
                                <ul class="space-y-2 text-sm text-gray-400">
                                    <li>• 建立书面工时记录制度</li>
                                    <li>• 研发材料全部入ERP系统</li>
                                    <li>• 系统数据与纸质单据双向核对</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-3 text-green-200">经验总结</h4>
                                <p class="text-sm text-gray-400">
                                    制度文件必须留痕，确保系统数据与纸质单据的一致性，建立可追溯的证据链。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 延伸阅读 -->
        <section id="reading" class="scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold font-serif mb-4">延伸阅读推荐</h2>
                <p class="text-xl text-gray-400">权威资料 · 深度研究 · 实务指南</p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-2xl mb-4 text-blue-400">
                        <i class="fas fa-book"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">《科创板IPO实务指南》</h3>
                    <p class="text-sm text-gray-400 mb-3">全面解析科创板IPO全流程，重点关注研发费用核查要点</p>
                    <a href="#" class="text-blue-400 text-sm hover:text-blue-300 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i>查看详情
                    </a>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-2xl mb-4 text-green-400">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">《IPO财务尽职调查要点》</h3>
                    <p class="text-sm text-gray-400 mb-3">知乎专栏深度文章，详解财务核查方法论</p>
                    <a href="https://zhuanlan.zhihu.com/p/536063344" class="text-green-400 text-sm hover:text-green-300 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i>立即阅读
                    </a>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-2xl mb-4 text-purple-400">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">《科创板研发核算规范》</h3>
                    <p class="text-sm text-gray-400 mb-3">搜狐专题分析，聚焦研发费用内控规范要求</p>
                    <a href="https://www.abacus.cn/3059.html" class="text-purple-400 text-sm hover:text-purple-300 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i>查看原文
                    </a>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-2xl mb-4 text-yellow-400">
                        <i class="fas fa-gavel"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">《现场督导案例汇编》</h3>
                    <p class="text-sm text-gray-400 mb-3">中国基金报权威解读，最新督导案例分析</p>
                    <a href="https://www.chnfund.com/article/AR2021063020024974129333" class="text-yellow-400 text-sm hover:text-yellow-300 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i>深度阅读
                    </a>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-2xl mb-4 text-red-400">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">《资本市场监管动态》</h3>
                    <p class="text-sm text-gray-400 mb-3">嘉源律师事务所月报，监管政策最新动向</p>
                    <a href="https://www.jiayuan-law.com/ueditor/net/upload/file/20250523/6388356643575000004659900.pdf" class="text-red-400 text-sm hover:text-red-300 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i>下载PDF
                    </a>
                </div>

                <div class="bg-gray-800/50 dark:bg-gray-100/5 rounded-xl p-6 hover-lift">
                    <div class="text-2xl mb-4 text-indigo-400">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">《IPO内控规范指南》</h3>
                    <p class="text-sm text-gray-400 mb-3">360Doc专题，内控制度规范化操作手册</p>
                    <a href="http://www.360doc.com/content/22/0531/18/48421311_1034000528.shtml" class="text-indigo-400 text-sm hover:text-indigo-300 transition-colors">
                        <i class="fas fa-external-link-alt mr-1"></i>查看指南
                    </a>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-gray-900/50 dark:bg-gray-100/5 border-t border-gray-700/50 dark:border-gray-200/10 mt-20">
        <div class="max-w-6xl mx-auto px-6 py-12">
            <div class="text-center">
                <p class="text-gray-400 text-sm">
                    本指南基于公开监管文件和权威案例分析整理，仅供学习参考
                    <br>
                    最新监管政策请以证监会官方发布为准
                </p>
            </div>
        </div>
    </footer>

    <script>
        // 主题切换
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        const body = document.body;

        // 初始化主题
        const savedTheme = localStorage.getItem('theme') || 'dark';
        setTheme(savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = body.classList.contains('dark-mode') ? 'dark' : 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            setTheme(newTheme);
            localStorage.setItem('theme', newTheme);
        });

        function setTheme(theme) {
            if (theme === 'light') {
                body.classList.remove('dark-mode');
                body.classList.add('light-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun text-yellow-500"></i>';
            } else {
                body.classList.remove('light-mode');
                body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-moon text-yellow-400"></i>';
            }
        }

        // 目录导航激活状态
        const tocLinks = document.querySelectorAll('.toc-link');
        const sections = document.querySelectorAll('section[id]');

        function updateActiveLink() {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.scrollY >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        }

        window.addEventListener('scroll', updateActiveLink);
        updateActiveLink();

        // 平滑滚动
        tocLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // 可展开内容
        const expandBtns = document.querySelectorAll('.expand-btn');
        expandBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const content = btn.parentElement.nextElementSibling;
                const icon = btn.querySelector('i');
                
                content.classList.toggle('expanded');
                icon.classList.toggle('rotated');
            });
        });

        // Mermaid 初始化
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                // 主要颜色
                primaryColor: '#3b82f6',
                primaryTextColor: '#ffffff',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                
                // 背景色
                background: 'transparent',
                mainBkg: '#1e293b',
                secondBkg: '#334155',
                tertiaryColor: '#475569',
                
                // 文本颜色
                textColor: '#e2e8f0',
                nodeTextColor: '#ffffff',
                
                // 边框颜色
                clusterBkg: '#1e293b',
                clusterBorder: '#475569',
                defaultLinkColor: '#64748b',
                
                // 标题颜色
                titleColor: '#e2e8f0',
                
                // 边标签背景
                edgeLabelBackground: 'rgba(15, 23, 42, 0.8)',
                
                // 节点颜色
                cScale0: '#3b82f6',
                cScale1: '#10b981',
                cScale2: '#f59e0b',
                cScale3: '#ef4444',
                cScale4: '#8b5cf6',
                cScale5: '#06b6d4',
                cScale6: '#84cc16',
                cScale7: '#f97316',
                cScale8: '#ec4899',
                cScale9: '#6366f1'
            },
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                padding: 20
            },
            fontFamily: 'Noto Sans SC, sans-serif'
        });

        // 图表交互控制
        function initializeMermaidControls() {
            const containers = document.querySelectorAll('.mermaid-container');

            containers.forEach(container => {
            const mermaidElement = container.querySelector('.mermaid');
            let scale = 1;
            let isDragging = false;
            let startX, startY, translateX = 0, translateY = 0;

            // 触摸相关状态
            let isTouch = false;
            let touchStartTime = 0;
            let initialDistance = 0;
            let initialScale = 1;
            let isPinching = false;

            // 缩放功能
            const zoomInBtn = container.querySelector('.zoom-in');
            const zoomOutBtn = container.querySelector('.zoom-out');
            const resetBtn = container.querySelector('.reset-zoom');
            const fullscreenBtn = container.querySelector('.fullscreen');

            function updateTransform() {
                mermaidElement.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;

                if (scale > 1) {
                container.classList.add('zoomed');
                } else {
                container.classList.remove('zoomed');
                }

                mermaidElement.style.cursor = isDragging ? 'grabbing' : 'grab';
            }

            if (zoomInBtn) {
                zoomInBtn.addEventListener('click', () => {
                scale = Math.min(scale * 1.25, 4);
                updateTransform();
                });
            }

            if (zoomOutBtn) {
                zoomOutBtn.addEventListener('click', () => {
                scale = Math.max(scale / 1.25, 0.3);
                if (scale <= 1) {
                    translateX = 0;
                    translateY = 0;
                }
                updateTransform();
                });
            }

            if (resetBtn) {
                resetBtn.addEventListener('click', () => {
                scale = 1;
                translateX = 0;
                translateY = 0;
                updateTransform();
                });
            }

            if (fullscreenBtn) {
                fullscreenBtn.addEventListener('click', () => {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
                });
            }

            // 鼠标拖拽
            mermaidElement.addEventListener('mousedown', (e) => {
                if (isTouch) return; // 如果是触摸设备，忽略鼠标事件

                isDragging = true;
                startX = e.clientX - translateX;
                startY = e.clientY - translateY;
                mermaidElement.style.cursor = 'grabbing';
                updateTransform();
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging && !isTouch) {
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                updateTransform();
                }
            });

            document.addEventListener('mouseup', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            document.addEventListener('mouseleave', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            // 获取两点之间的距离
            function getTouchDistance(touch1, touch2) {
                return Math.hypot(
                touch2.clientX - touch1.clientX,
                touch2.clientY - touch1.clientY
                );
            }

            // 触摸事件处理
            mermaidElement.addEventListener('touchstart', (e) => {
                isTouch = true;
                touchStartTime = Date.now();

                if (e.touches.length === 1) {
                // 单指拖动
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;

                } else if (e.touches.length === 2) {
                // 双指缩放
                isPinching = true;
                isDragging = false;

                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                initialDistance = getTouchDistance(touch1, touch2);
                initialScale = scale;
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchmove', (e) => {
                if (e.touches.length === 1 && isDragging && !isPinching) {
                // 单指拖动
                const touch = e.touches[0];
                translateX = touch.clientX - startX;
                translateY = touch.clientY - startY;
                updateTransform();

                } else if (e.touches.length === 2 && isPinching) {
                // 双指缩放
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                const currentDistance = getTouchDistance(touch1, touch2);

                if (initialDistance > 0) {
                    const newScale = Math.min(Math.max(
                    initialScale * (currentDistance / initialDistance),
                    0.3
                    ), 4);
                    scale = newScale;
                    updateTransform();
                }
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchend', (e) => {
                // 重置状态
                if (e.touches.length === 0) {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                // 延迟重置isTouch，避免鼠标事件立即触发
                setTimeout(() => {
                    isTouch = false;
                }, 100);
                } else if (e.touches.length === 1 && isPinching) {
                // 从双指变为单指，切换为拖动模式
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;
                }

                if (scale <= 1) {
                translateX = 0;
                translateY = 0;
                updateTransform();
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchcancel', (e) => {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                setTimeout(() => {
                isTouch = false;
                }, 100);

                if (scale <= 1) {
                translateX = 0;
                translateY = 0;
                updateTransform();
                }

                e.preventDefault();
            }, { passive: false });

            // 缩放限制和边界检查
            function checkBounds() {
                if (scale <= 1) {
                translateX = 0;
                translateY = 0;
                } else {
                const rect = container.getBoundingClientRect();
                const elementRect = mermaidElement.getBoundingClientRect();
                
                // 计算边界
                const maxX = Math.max(0, (elementRect.width * scale - rect.width) / 2);
                const maxY = Math.max(0, (elementRect.height * scale - rect.height) / 2);
                
                translateX = Math.max(-maxX, Math.min(maxX, translateX));
                translateY = Math.max(-maxY, Math.min(maxY, translateY));
                }
                
                updateTransform();
            }

            // 滚轮缩放
            container.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                const newScale = Math.min(Math.max(scale * delta, 0.3), 4);
                
                if (newScale !== scale) {
                scale = newScale;
                checkBounds();
                }
            });

            // 初始化
            updateTransform();
            });
        }

        // 页面加载完成后初始化图表控制
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initializeMermaidControls, 1000);
        });
    </script>
</body>
</html>
```