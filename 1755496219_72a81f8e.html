```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>股份支付会计处理：基准日前授予的准则解析</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js"></script>
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-error: #ef4444;
            --border-primary: #475569;
            --border-secondary: #64748b;
        }

        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #e2e8f0;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border-primary: #e2e8f0;
            --border-secondary: #cbd5e1;
        }

        body {
            font-family: "Noto Sans SC", Tahoma, Arial, Roboto, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            transition: all 0.3s ease;
        }

        .serif {
            font-family: "Noto Serif SC", serif;
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        [data-theme="light"] .glass-card {
            background: rgba(248, 250, 252, 0.8);
        }

        .glass-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .hero-gradient {
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.1) 0%, 
                rgba(139, 92, 246, 0.1) 100%);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 8px;
            width: 12px;
            height: 12px;
            background: var(--accent-primary);
            border-radius: 50%;
            border: 3px solid var(--bg-primary);
        }

        [data-theme="light"] .timeline-item::before {
            border-color: var(--bg-secondary);
        }

        .decision-node {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .decision-option {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
            transition: all 0.3s ease;
        }

        [data-theme="light"] .decision-option {
            background: var(--bg-tertiary);
        }

        .decision-option:hover {
            border-color: var(--accent-primary);
            transform: translateX(4px);
        }

        .citation-link {
            color: var(--accent-primary);
            text-decoration: none;
            font-size: 0.875rem;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .citation-link:hover {
            opacity: 1;
            text-decoration: underline;
        }

        .highlight-box {
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.1) 0%, 
                rgba(59, 130, 246, 0.1) 100%);
            border-left: 4px solid var(--accent-success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .warning-box {
            background: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.1) 0%, 
                rgba(239, 68, 68, 0.1) 100%);
            border-left: 4px solid var(--accent-warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        /* Mermaid diagram styling */
        .mermaid-container {
            display: flex;
            justify-content: center;
            min-height: 300px;
            max-height: 800px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-primary);
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        [data-theme="light"] .mermaid-container {
            background: var(--bg-tertiary);
        }

        .mermaid-container .mermaid {
            width: 100%;
            max-width: 100%;
            height: 100%;
            cursor: grab;
            transition: transform 0.3s ease;
            transform-origin: center center;
            display: flex;
            justify-content: center;
            align-items: center;
            touch-action: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .mermaid-container .mermaid svg {
            max-width: 100%;
            height: 100%;
            display: block;
            margin: 0 auto;
        }

        .mermaid-container .mermaid:active {
            cursor: grabbing;
        }

        .mermaid-container.zoomed .mermaid {
            height: 100%;
            width: 100%;
            cursor: grab;
        }

        .mermaid-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            z-index: 20;
            background: var(--bg-primary);
            padding: 8px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        [data-theme="light"] .mermaid-controls {
            background: var(--bg-secondary);
        }

        .mermaid-control-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 6px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-primary);
            font-size: 14px;
            min-width: 36px;
            height: 36px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        [data-theme="light"] .mermaid-control-btn {
            background: var(--bg-tertiary);
        }

        .mermaid-control-btn:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-primary);
        }

        .mermaid-control-btn:active {
            transform: scale(0.9);
        }

        /* Enhanced mermaid styling for dark/light mode */
        .mermaid .node rect,
        .mermaid .node circle,
        .mermaid .node ellipse,
        .mermaid .node polygon {
            stroke-width: 2px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        [data-theme="light"] .mermaid .node rect,
        [data-theme="light"] .mermaid .node circle,
        [data-theme="light"] .mermaid .node ellipse,
        [data-theme="light"] .mermaid .node polygon {
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.05));
        }

        /* Ensure mermaid SVGs are responsive */
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }

        @media (max-width: 768px) {
            .mermaid-container {
                padding: 15px;
            }
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-secondary);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="sticky top-0 z-50 glass-card backdrop-blur-md border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i class="fas fa-chart-line text-2xl gradient-text mr-3"></i>
                    <span class="text-xl font-bold serif">股份支付准则解析</span>
                </div>
                <button id="theme-toggle" 
                        class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                    <i class="fas fa-moon" id="theme-icon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="relative overflow-hidden hero-gradient">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
            <div class="text-center">
                <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold serif mb-6">
                    <span class="gradient-text">基准日前授予的股份支付</span>
                </h1>
                <p class="text-xl sm:text-2xl text-gray-600 dark:text-gray-400 mb-8 max-w-3xl mx-auto">
                    基于《企业会计准则第11号》的权威解读与IPO审核实践
                </p>
                <div class="flex justify-center space-x-4">
                    <span class="glass-card px-4 py-2 text-sm">
                        <i class="fas fa-gavel text-blue-500 mr-2"></i>企业会计准则
                    </span>
                    <span class="glass-card px-4 py-2 text-sm">
                        <i class="fas fa-chart-bar text-purple-500 mr-2"></i>IPO审核
                    </span>
                    <span class="glass-card px-4 py-2 text-sm">
                        <i class="fas fa-balance-scale text-green-500 mr-2"></i>实务案例
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <!-- Executive Summary -->
        <section class="mb-16">
            <div class="glass-card p-8">
                <h2 class="text-3xl font-bold serif mb-6 flex items-center">
                    <i class="fas fa-key text-blue-500 mr-3"></i>
                    核心结论
                </h2>
                <div class="highlight-box">
                    <p class="text-lg leading-relaxed">
                        <strong>基准日前签署的股份支付协议，其费用确认时点完全取决于是否存在等待期。</strong>
                        <br><br>
                        无等待期 → 授予日一次性计入报告期<br>
                        有等待期 → 按服务期比例分摊至各报告期
                    </p>
                </div>
            </div>
        </section>

        <!-- Decision Tree -->
        <section class="mb-16">
            <div class="glass-card p-8">
                <h2 class="text-3xl font-bold serif mb-6 flex items-center">
                    <i class="fas fa-sitemap text-purple-500 mr-3"></i>
                    决策流程图
                </h2>
                <div class="mermaid-container">
                    <div class="mermaid-controls">
                        <button class="mermaid-control-btn zoom-in" title="放大">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="mermaid-control-btn zoom-out" title="缩小">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button class="mermaid-control-btn reset-zoom" title="重置">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <button class="mermaid-control-btn fullscreen" title="全屏查看">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                    <div class="mermaid" id="decision-tree">
                        flowchart TD
                            A["基准日前授予股权激励"] --> B{"是否存在等待期/服务期?"}
                            B -->|"是"| C["等待期分摊确认费用"]
                            B -->|"否"| D["授予日一次性确认"]
                            C --> E["按服务期比例计入各报告期"]
                            D --> F["全额计入授予日所在报告期"]
                            E --> G["影响当期净利润"]
                            F --> G
                            
                            style A fill:#3b82f6,stroke:#1e40af,stroke-width:3px,color:#fff
                            style B fill:#8b5cf6,stroke:#7c3aed,stroke-width:3px,color:#fff
                            style C fill:#10b981,stroke:#047857,stroke-width:3px,color:#fff
                            style D fill:#10b981,stroke:#047857,stroke-width:3px,color:#fff
                            style E fill:#f59e0b,stroke:#d97706,stroke-width:3px,color:#fff
                            style F fill:#f59e0b,stroke:#d97706,stroke-width:3px,color:#fff
                            style G fill:#ef4444,stroke:#dc2626,stroke-width:3px,color:#fff
                    </div>
                </div>
            </div>
        </section>

        <!-- Detailed Analysis -->
        <section class="mb-16">
            <div class="grid gap-8 lg:grid-cols-2">
                <!-- No Waiting Period -->
                <div class="glass-card p-8">
                    <h3 class="text-2xl font-bold serif mb-4 flex items-center">
                        <i class="fas fa-bolt text-green-500 mr-3"></i>
                        无等待期处理
                    </h3>
                    <div class="space-y-4">
                        <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                            <h4 class="font-semibold text-green-800 dark:text-green-200 mb-2">
                                <i class="fas fa-check-circle mr-2"></i>会计处理依据
                            </h4>
                            <p class="text-sm text-green-700 dark:text-green-300">
                                《股份支付》第五条：授予后立即可行权的换取职工服务的权益结算股份支付，应在授予日按公允价值计入相关成本费用<a href="#ref-1" class="citation-link">[1]</a>
                            </p>
                        </div>
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-800 dark:text-blue-200 mb-2">
                                <i class="fas fa-calendar mr-2"></i>报告期影响
                            </h4>
                            <p class="text-sm text-blue-700 dark:text-blue-300">
                                费用全额计入授予日所在年度报表，直接影响当期净利润
                            </p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">
                                <i class="fas fa-file-alt mr-2"></i>典型案例
                            </h4>
                            <p class="text-sm text-gray-700 dark:text-gray-300">
                                某企业2021年授予员工限制性股票时未约定服务期，股份支付费用7,500万元一次性计入2021年度损益<a href="#ref-3" class="citation-link">[3]</a>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- With Waiting Period -->
                <div class="glass-card p-8">
                    <h3 class="text-2xl font-bold serif mb-4 flex items-center">
                        <i class="fas fa-clock text-purple-500 mr-3"></i>
                        有等待期处理
                    </h3>
                    <div class="space-y-4">
                        <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg">
                            <h4 class="font-semibold text-purple-800 dark:text-purple-200 mb-2">
                                <i class="fas fa-check-circle mr-2"></i>会计处理依据
                            </h4>
                            <p class="text-sm text-purple-700 dark:text-purple-300">
                                《股份支付》第六条：存在等待期的股份支付，应在等待期内每个资产负债表日对可行权数量作最佳估计，按授予日公允价值分期确认费用<a href="#ref-4" class="citation-link">[4]</a>
                            </p>
                        </div>
                        <div class="bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg">
                            <h4 class="font-semibold text-orange-800 dark:text-orange-200 mb-2">
                                <i class="fas fa-chart-line mr-2"></i>分摊方式
                            </h4>
                            <p class="text-sm text-orange-700 dark:text-orange-300">
                                费用按服务期比例分摊，例如3年等待期中第1年在报告期内，则1/3费用计入报告期
                            </p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">
                                <i class="fas fa-gavel mr-2"></i>监管要求
                            </h4>
                            <p class="text-sm text-gray-700 dark:text-gray-300">
                                离职需按原价回购股份，实质构成服务期条件，必须分期确认费用<a href="#ref-6" class="citation-link">[6]</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Special Cases -->
        <section class="mb-16">
            <div class="glass-card p-8">
                <h2 class="text-3xl font-bold serif mb-6 flex items-center">
                    <i class="fas fa-exclamation-triangle text-yellow-500 mr-3"></i>
                    特殊情形：IPO成功作为行权条件
                </h2>
                
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-gray-200 dark:border-gray-700">
                                <th class="text-left p-4 font-semibold">情形</th>
                                <th class="text-left p-4 font-semibold">会计处理</th>
                                <th class="text-left p-4 font-semibold">报告期影响</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-100 dark:border-gray-800">
                                <td class="p-4">
                                    <div class="flex items-center">
                                        <i class="fas fa-user-clock text-blue-500 mr-2"></i>
                                        隐含持续服务要求
                                    </div>
                                </td>
                                <td class="p-4">
                                    合理估计IPO时点作为等待期终点，费用在授予日至预计IPO日之间分摊<a href="#ref-7" class="citation-link">[7]</a>
                                </td>
                                <td class="p-4">
                                    分摊至报告期内涉及的服务期间
                                </td>
                            </tr>
                            <tr>
                                <td class="p-4">
                                    <div class="flex items-center">
                                        <i class="fas fa-unlock text-green-500 mr-2"></i>
                                        无服务要求仅附IPO条件
                                    </div>
                                </td>
                                <td class="p-4">
                                    若员工离职仍可保留股份，则一次性确认费用<a href="#ref-8" class="citation-link">[8]</a>
                                </td>
                                <td class="p-4">
                                    全额计入授予日所在报告期
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-6 highlight-box">
                    <p class="text-sm">
                        <i class="fas fa-info-circle mr-2"></i>
                        <strong>案例指引：</strong>财政部《股份支付准则应用案例》明确，若约定"IPO前离职需原价回购"，则构成服务期限条件，必须分期确认费用<a href="#ref-9" class="citation-link">[9]</a>
                    </p>
                </div>
            </div>
        </section>

        <!-- Risk Points -->
        <section class="mb-16">
            <div class="glass-card p-8">
                <h2 class="text-3xl font-bold serif mb-6 flex items-center">
                    <i class="fas fa-shield-alt text-red-500 mr-3"></i>
                    监管审核关键风险点
                </h2>
                
                <div class="grid gap-6 md:grid-cols-3">
                    <div class="warning-box">
                        <h3 class="font-bold mb-2 flex items-center">
                            <i class="fas fa-calendar-times text-red-500 mr-2"></i>
                            费用跨期调节风险
                        </h3>
                        <p class="text-sm">
                            故意不设服务期将费用集中计入报告期外，可能被质疑规避净利润要求<a href="#ref-10" class="citation-link">[10]</a>
                        </p>
                    </div>
                    
                    <div class="warning-box">
                        <h3 class="font-bold mb-2 flex items-center">
                            <i class="fas fa-calculator text-orange-500 mr-2"></i>
                            公允价值合理性
                        </h3>
                        <p class="text-sm">
                            授予日公允价值需参考同期外部投资者入股价或评估值，明显偏低需补提费用<a href="#ref-11" class="citation-link">[11]</a>
                        </p>
                    </div>
                    
                    <div class="warning-box">
                        <h3 class="font-bold mb-2 flex items-center">
                            <i class="fas fa-file-contract text-yellow-500 mr-2"></i>
                            披露一致性
                        </h3>
                        <p class="text-sm">
                            招股书需披露费用确认政策，问询中需论证等待期判断的合规性<a href="#ref-12" class="citation-link">[12]</a>
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Conclusion -->
        <section class="mb-16">
            <div class="glass-card p-8">
                <h2 class="text-3xl font-bold serif mb-6 flex items-center">
                    <i class="fas fa-check-double text-green-500 mr-3"></i>
                    结论汇总
                </h2>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b-2 border-gray-300 dark:border-gray-600">
                                <th class="text-left p-4 font-bold">授予协议条款</th>
                                <th class="text-center p-4 font-bold">报告期内确认费用</th>
                                <th class="text-left p-4 font-bold">确认方式</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-200 dark:border-gray-700">
                                <td class="p-4">无服务期/业绩条件（含仅IPO条件但无回购条款）</td>
                                <td class="text-center p-4">
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                                        ✔️ 是
                                    </span>
                                </td>
                                <td class="p-4 font-medium text-green-600 dark:text-green-400">一次性计入</td>
                            </tr>
                            <tr class="border-b border-gray-200 dark:border-gray-700">
                                <td class="p-4">约定服务期/业绩条件</td>
                                <td class="text-center p-4">
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                                        ✔️ 是（按服务期比例）
                                    </span>
                                </td>
                                <td class="p-4 font-medium text-blue-600 dark:text-blue-400">分期确认</td>
                            </tr>
                            <tr>
                                <td class="p-4">隐含服务期（如离职需原价回购）</td>
                                <td class="text-center p-4">
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                                        ✔️ 是（按服务期比例）
                                    </span>
                                </td>
                                <td class="p-4 font-medium text-blue-600 dark:text-blue-400">分期确认</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-6 highlight-box">
                    <p class="flex items-start">
                        <i class="fas fa-exclamation-circle text-yellow-500 mr-2 mt-1"></i>
                        <span>
                            <strong>实务提示：</strong>基准日前签署的协议若在报告期内授予，必须按上述原则处理；若授予日在基准日后，则不属于报告期事项（但需在申报前完成股份支付会计处理）<a href="#ref-13" class="citation-link">[13]</a>
                        </span>
                    </p>
                </div>
            </div>
        </section>

        <!-- Further Reading -->
        <section class="mb-16">
            <div class="glass-card p-8">
                <h2 class="text-3xl font-bold serif mb-6 flex items-center">
                    <i class="fas fa-book-open text-indigo-500 mr-3"></i>
                    延伸阅读
                </h2>
                
                <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                    <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg hover:shadow-lg transition-shadow">
                        <h3 class="font-bold mb-2 text-sm">企业会计准则第11号</h3>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-2">财政部</p>
                        <p class="text-xs">股份支付准则权威文件</p>
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg hover:shadow-lg transition-shadow">
                        <h3 class="font-bold mb-2 text-sm">监管规则适用指引——发行类第5号</h3>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-2">证监会</p>
                        <p class="text-xs">IPO审核中股份支付处理要点</p>
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg hover:shadow-lg transition-shadow">
                        <h3 class="font-bold mb-2 text-sm">股份支付准则案例解析</h3>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-2">财政部会计司</p>
                        <p class="text-xs">以IPO成功为可行权条件的案例</p>
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg hover:shadow-lg transition-shadow">
                        <h3 class="font-bold mb-2 text-sm">科创板股票发行上市审核问答</h3>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-2">上交所</p>
                        <p class="text-xs">申报前新增股东的股份支付处理</p>
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg hover:shadow-lg transition-shadow">
                        <h3 class="font-bold mb-2 text-sm">上市公司执行企业会计准则案例解析</h3>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-2">证监会</p>
                        <p class="text-xs">第九章股份支付案例详解</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- References -->
    <section class="bg-gray-50 dark:bg-gray-800 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-2xl font-bold serif mb-6">参考文献</h2>
            <ul class="space-y-2 text-sm">
                <li id="ref-1">[1] 《企业会计准则第11号——股份支付》第五条，财政部</li>
                <li id="ref-2">[2] 证监会《监管规则适用指引——发行类第5号》问题1："增资或转让股份形成的股份支付"</li>
                <li id="ref-3">[3] 《拟上市公司股权激励研究》（中伦律师事务所）P12：无等待期案例</li>
                <li id="ref-4">[4] 《企业会计准则第11号——股份支付》第六条</li>
                <li id="ref-5">[5] 《上市公司执行企业会计准则案例解析（2020）》第九章案例9-2</li>
                <li id="ref-6">[6] 证监会《监管规则适用指引——发行类第5号》问题1："离职按原价回购视为隐含服务期"</li>
                <li id="ref-7">[7] 财政部《股份支付准则应用案例——以首次公开募股成功为可行权条件》</li>
                <li id="ref-8">[8] 科创板审核案例：<strong>南微医学（688029）</strong>问询回复</li>
                <li id="ref-9">[9] 财政部《股份支付准则应用案例》2021年修订版案例三</li>
                <li id="ref-10">[10] 《IPO 月度动态（2022年5月）》："第五套标准企业突击确认费用"风险提示</li>
                <li id="ref-11">[11] 《监管规则适用指引——发行类第5号》问题1："公允价值应参考同期外部融资价格"</li>
                <li id="ref-12">[12] 知识库案例：<strong>云从科技（688327）</strong>首轮问询问题3</li>
                <li id="ref-13">[13] 上交所《科创板股票发行上市审核问答》问题24："申报前新增股东需完成股份支付处理"</li>
            </ul>
        </div>
    </section>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        
        // Check for saved theme preference or default to system preference
        const savedTheme = localStorage.getItem('theme');
        const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        const currentTheme = savedTheme || systemTheme;
        
        // Apply theme
        document.documentElement.setAttribute('data-theme', currentTheme);
        updateThemeIcon(currentTheme);
        
        themeToggle.addEventListener('click', () => {
            const newTheme = document.documentElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });
        
        function updateThemeIcon(theme) {
            themeIcon.className = theme === 'light' ? 'fas fa-sun' : 'fas fa-moon';
        }
        
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                // Primary colors with high contrast
                primaryColor: '#3b82f6',
                primaryTextColor: '#ffffff',
                primaryBorderColor: '#1e40af',
                
                // Secondary colors
                secondaryColor: '#8b5cf6',
                secondaryTextColor: '#ffffff',
                secondaryBorderColor: '#7c3aed',
                
                // Tertiary colors
                tertiaryColor: '#10b981',
                tertiaryTextColor: '#ffffff',
                tertiaryBorderColor: '#047857',
                
                // Background and text
                background: '#0f172a',
                mainBkg: '#1e293b',
                secondBkg: '#334155',
                lineColor: '#64748b',
                
                // Text colors for better contrast
                nodeTextColor: '#f8fafc',
                textColor: '#f8fafc',
                
                // Additional contrast improvements
                clusterBkg: '#1e293b',
                clusterBorder: '#475569',
                defaultLinkColor: '#64748b',
                titleColor: '#f8fafc',
                
                // Ensure edges are visible
                edgeLabelBackground: '#1e293b',
                nodeBorder: '#475569',
                
                // Dark theme adjustments
                darkMode: true
            },
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                padding: 20
            },
            fontFamily: 'Noto Sans SC, sans-serif',
            fontSize: 14
        });

        // Initialize Mermaid Controls for zoom and pan
        function initializeMermaidControls() {
            const containers = document.querySelectorAll('.mermaid-container');

            containers.forEach(container => {
            const mermaidElement = container.querySelector('.mermaid');
            let scale = 1;
            let isDragging = false;
            let startX, startY, translateX = 0, translateY = 0;

            // 触摸相关状态
            let isTouch = false;
            let touchStartTime = 0;
            let initialDistance = 0;
            let initialScale = 1;
            let isPinching = false;

            // Zoom controls
            const zoomInBtn = container.querySelector('.zoom-in');
            const zoomOutBtn = container.querySelector('.zoom-out');
            const resetBtn = container.querySelector('.reset-zoom');
            const fullscreenBtn = container.querySelector('.fullscreen');

            function updateTransform() {
                mermaidElement.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;

                if (scale > 1) {
                container.classList.add('zoomed');
                } else {
                container.classList.remove('zoomed');
                }

                mermaidElement.style.cursor = isDragging ? 'grabbing' : 'grab';
            }

            if (zoomInBtn) {
                zoomInBtn.addEventListener('click', () => {
                scale = Math.min(scale * 1.25, 4);
                updateTransform();
                });
            }

            if (zoomOutBtn) {
                zoomOutBtn.addEventListener('click', () => {
                scale = Math.max(scale / 1.25, 0.3);
                if (scale <= 1) {
                    translateX = 0;
                    translateY = 0;
                }
                updateTransform();
                });
            }

            if (resetBtn) {
                resetBtn.addEventListener('click', () => {
                scale = 1;
                translateX = 0;
                translateY = 0;
                updateTransform();
                });
            }

            if (fullscreenBtn) {
                fullscreenBtn.addEventListener('click', () => {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
                });
            }

            // Mouse Events
            mermaidElement.addEventListener('mousedown', (e) => {
                if (isTouch) return; // 如果是触摸设备，忽略鼠标事件

                isDragging = true;
                startX = e.clientX - translateX;
                startY = e.clientY - translateY;
                mermaidElement.style.cursor = 'grabbing';
                updateTransform();
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging && !isTouch) {
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                updateTransform();
                }
            });

            document.addEventListener('mouseup', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            document.addEventListener('mouseleave', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            // 获取两点之间的距离
            function getTouchDistance(touch1, touch2) {
                return Math.hypot(
                touch2.clientX - touch1.clientX,
                touch2.clientY - touch1.clientY
                );
            }

            // Touch Events - 触摸事件处理
            mermaidElement.addEventListener('touchstart', (e) => {
                isTouch = true;
                touchStartTime = Date.now();

                if (e.touches.length === 1) {
                // 单指拖动
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;

                } else if (e.touches.length === 2) {
                // 双指缩放
                isPinching = true;
                isDragging = false;

                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                initialDistance = getTouchDistance(touch1, touch2);
                initialScale = scale;
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchmove', (e) => {
                if (e.touches.length === 1 && isDragging && !isPinching) {
                // 单指拖动
                const touch = e.touches[0];
                translateX = touch.clientX - startX;
                translateY = touch.clientY - startY;
                updateTransform();

                } else if (e.touches.length === 2 && isPinching) {
                // 双指缩放
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                const currentDistance = getTouchDistance(touch1, touch2);

                if (initialDistance > 0) {
                    const newScale = Math.min(Math.max(
                    initialScale * (currentDistance / initialDistance),
                    0.3
                    ), 4);
                    scale = newScale;
                    updateTransform();
                }
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchend', (e) => {
                // 重置状态
                if (e.touches.length === 0) {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                // 延迟重置isTouch，避免鼠标事件立即触发
                setTimeout(() => {
                    isTouch = false;
                }, 100);
                } else if (e.touches.length === 1 && isPinching) {
                // 从双指变为单指，切换为拖动模式
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;
                }

                updateTransform();
            });

            mermaidElement.addEventListener('touchcancel', (e) => {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                setTimeout(() => {
                isTouch = false;
                }, 100);

                updateTransform();
            });

            // Enhanced wheel zoom with better center point handling
            container.addEventListener('wheel', (e) => {
                e.preventDefault();
                const rect = container.getBoundingClientRect();
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                const newScale = Math.min(Math.max(scale * delta, 0.3), 4);

                // Adjust translation to zoom towards center
                if (newScale !== scale) {
                const scaleDiff = newScale / scale;
                translateX = translateX * scaleDiff;
                translateY = translateY * scaleDiff;
                scale = newScale;

                if (scale <= 1) {
                    translateX = 0;
                    translateY = 0;
                }

                updateTransform();
                }
            });

            // Initialize display
            updateTransform();
            });
        }

        // Initialize mermaid controls after charts are rendered
        setTimeout(initializeMermaidControls, 1000);

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Add subtle hover effects to cards
        document.querySelectorAll('.glass-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    </script>
</body>
</html>
```